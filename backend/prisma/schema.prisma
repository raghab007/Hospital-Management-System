generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id            Int           @id @default(autoincrement())
    email         String        @unique
    role          String
    password      String
    firstName     String
    lastName      String
    contactNumber String
    createdAt     DateTime      @default(now())
    Patient       Patient?
    Doctor        Doctor?
    Appointment   Appointment[]
}

model Patient {
    id           Int           @id @default(autoincrement())
    user         User          @relation(fields: [id], references: [id])
    district     String
    municipality String
    wardNo       String
    gender       String        @default("Male")
    Appointment  Appointment[]
}

model Appointment {
    id                  Int        @id @default(autoincrement())
    appointmentDateTime DateTime   @db.Timestamptz(6) // Appointed patient
    patient             Patient    @relation(fields: [patientId], references: [id])
    // Who appoointed the patient
    user                User       @relation(fields: [userId], references: [id])
    userId              Int
    doctor              Doctor     @relation(fields: [doctorId], references: [id])
    patientId           Int
    doctorId            Int
    department          Department @relation(fields: [departmentId], references: [id])
    departmentId        Int
    // createdTime         DateTime
}

model Doctor {
    id           Int           @id @default(autoincrement())
    user         User          @relation(fields: [id], references: [id])
    speciality   String
    available    Boolean       @default(true)
    departmentId Int
    address      String
    bio          String
    department   Department    @relation(fields: [departmentId], references: [id])
    Appointments Appointment[]
    timeSlots    Timeslots[]
}

model Department {
    id          Int           @id @default(autoincrement())
    name        String
    description String
    doctors     Doctor[]
    Appointment Appointment[]
}

model Timeslots {
    id       Int    @id @default(autoincrement())
    doctor   Doctor @relation(fields: [doctorId], references: [id])
    doctorId Int
    Time     Time   @relation(fields: [timeId], references: [id])
    timeId   Int
}

model Time {
    id        Int         @id @default(autoincrement())
    time      String
    timeSlots Timeslots[]
}

// enum Role {
//     ADMIN
//     PATIENT
// }
